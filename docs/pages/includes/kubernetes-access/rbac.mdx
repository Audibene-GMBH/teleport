To use Teleport to interact with a Kubernetes cluster, your Teleport roles must
allow access from your Kubernetes user and groups. Ensure that you have a
Teleport role that grants access to the cluster you plan to interact with.

Run the following command to get the Kubernetes user for your current context:

```code
$ kubectl config view \
-o jsonpath="{.contexts[?(@.context.cluster==\"$(kubectl config current-context)\")].context.user}"
```

Create a file called `kube-user.yaml` with the following content, replacing
`USER` with the output of the command above.

```yaml
kind: role
metadata:
  name: kube-user
version: v5
spec:
  allow:
    kubernetes_labels:
      '*': '*'
    kubernetes_groups:
    - basic-viewers
    kubernetes_users:
    - USER
  deny: {}
```

Retrieve your user:

```code
$ TELEPORT_USER=myuser
$ tctl get user/${TELEPORT_USER?} > user.yaml
```

Add `kube-user` to your Teleport user's list of roles:

```diff
   roles:
   - access
   - auditor
+  - kube-user
```

Apply your changes:

```code
$ tctl create -f kube-user.yaml
$ tctl create -f user.yaml
```

Create a ClusterRoleBinding for the "basic-viewers" group:

```code
$ cat <<EOF | kubectl apply -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: basic-viewers-bind
subjects:
- kind: Group
  name: basic-viewers # corresponds to the kubernetes_group we assigned our "kube-user" role above
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: view # A default ClusterRole with read-only access: https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles
  apiGroup: rbac.authorization.k8s.io
EOF

```

Log out of Teleport and log in again.
